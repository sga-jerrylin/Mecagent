<template>
  <div id="app" class="app-container">
    <!-- 全局导航栏 -->
    <nav class="app-nav">
      <div class="nav-content">
        <div class="nav-brand">
          <div class="brand-icon">
            <el-icon size="24"><Setting /></el-icon>
          </div>
          <div class="brand-text">
            <h1>智能装配说明书</h1>
            <span>AI Assembly Manual Generator</span>
          </div>
        </div>
        
        <div class="nav-menu">
          <router-link to="/" class="nav-item" active-class="active">
            <el-icon><House /></el-icon>
            <span>首页</span>
          </router-link>
          <router-link to="/generator" class="nav-item" active-class="active">
            <el-icon><DocumentAdd /></el-icon>
            <span>生成器</span>
          </router-link>
          <router-link to="/viewer" class="nav-item" active-class="active">
            <el-icon><View /></el-icon>
            <span>查看器</span>
          </router-link>
        </div>
        
        <div class="nav-actions">
          <el-button 
            :icon="isDark ? 'Sunny' : 'Moon'" 
            circle 
            @click="toggleDark"
            class="theme-toggle"
          />
          <el-button type="primary" @click="showHelp">
            <el-icon><QuestionFilled /></el-icon>
            帮助
          </el-button>
        </div>
      </div>
    </nav>

    <!-- 主要内容区域 -->
    <main class="app-main">
      <router-view v-slot="{ Component }">
        <transition name="page" mode="out-in">
          <component :is="Component" />
        </transition>
      </router-view>
    </main>

    <!-- 全局背景效果 -->
    <div class="bg-effects">
      <div class="bg-grid"></div>
      <div class="bg-gradient"></div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { useDark, useToggle } from '@vueuse/core'

const isDark = useDark()
const toggleDark = useToggle(isDark)

const showHelp = () => {
  ElMessageBox.alert(
    '这是一个智能装配说明书生成系统，支持PDF图纸和3D模型的自动解析，生成工人友好的装配说明书。',
    '系统帮助',
    {
      confirmButtonText: '了解',
      type: 'info'
    }
  )
}
</script>

<style lang="scss">
.app-container {
  min-height: 100vh;
  background: var(--el-bg-color);
  position: relative;
  overflow-x: hidden;
}

.app-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 70px;
  background: rgba(var(--el-bg-color-rgb), 0.8);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--el-border-color-light);
  z-index: 1000;
  
  .nav-content {
    max-width: 1400px;
    margin: 0 auto;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
  }
  
  .nav-brand {
    display: flex;
    align-items: center;
    gap: 12px;
    
    .brand-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #409eff, #67c23a);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    
    .brand-text {
      h1 {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
        color: var(--el-text-color-primary);
      }
      
      span {
        font-size: 12px;
        color: var(--el-text-color-secondary);
        font-weight: 400;
      }
    }
  }
  
  .nav-menu {
    display: flex;
    gap: 8px;
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 8px;
      text-decoration: none;
      color: var(--el-text-color-regular);
      transition: all 0.3s ease;
      
      &:hover {
        background: var(--el-fill-color-light);
        color: var(--el-color-primary);
      }
      
      &.active {
        background: var(--el-color-primary-light-9);
        color: var(--el-color-primary);
      }
    }
  }
  
  .nav-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    
    .theme-toggle {
      background: var(--el-fill-color-light);
      border: none;
    }
  }
}

.app-main {
  margin-top: 70px;
  min-height: calc(100vh - 70px);
  position: relative;
  z-index: 1;
}

.bg-effects {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 0;
  
  .bg-grid {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      linear-gradient(rgba(var(--el-color-primary-rgb), 0.05) 1px, transparent 1px),
      linear-gradient(90deg, rgba(var(--el-color-primary-rgb), 0.05) 1px, transparent 1px);
    background-size: 50px 50px;
    animation: grid-move 20s linear infinite;
  }
  
  .bg-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      circle at 20% 80%,
      rgba(var(--el-color-primary-rgb), 0.1) 0%,
      transparent 50%
    ),
    radial-gradient(
      circle at 80% 20%,
      rgba(var(--el-color-success-rgb), 0.1) 0%,
      transparent 50%
    );
  }
}

@keyframes grid-move {
  0% { transform: translate(0, 0); }
  100% { transform: translate(50px, 50px); }
}

// 页面切换动画
.page-enter-active,
.page-leave-active {
  transition: all 0.3s ease;
}

.page-enter-from {
  opacity: 0;
  transform: translateY(20px);
}

.page-leave-to {
  opacity: 0;
  transform: translateY(-20px);
}
</style>
